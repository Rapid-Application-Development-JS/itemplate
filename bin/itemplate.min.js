!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.itemplate=t()}(this,function(){function e(e){for(var t={},n=e.split(","),r=0;r<n.length;r++)t[n[r]]=!0;return t}function t(e){return e.replace(P.escape,function(e){return P.MAP[e]})}function n(){k.length=0,C=null,k.push("var lib=IncrementalDOM,o=lib.elementOpen,c=lib.elementClose,t=lib.text,v=lib.elementVoid;")}function r(e,t,n){var r=new RegExp(t+"(.*?)"+n,"g"),a=!0,s=!0,l=e.replace(r,function(e,t,n,r){return 0!==n?t="'+"+t:a=!1,r.length-(n+e.length)>0?t+="+'":s=!1,t});return(a?"'":"")+l+(s?"'":"")}function a(e){return e.replace(P.template.interpolate,function(e,t){return P.helpers.open+t+P.helpers.close}).replace(P.template.escape,function(e,n){return P.helpers.open+t(n)+P.helpers.close}).replace(P.template.evaluate,function(e,t){return"<evaluate>"+t.replace(A," ").trim()+"</evaluate>"})}function s(e,t,n){var r="";if(0!==t.length){if("string"==typeof t)r=n?t:"'"+t.replace("'","\\'")+"'";else for(var a=0;a<t.length;a++)a>0&&(r+=", "),r+=t[a];k.push(e+"("+r+");")}}function l(e,t){k.push(t?e:e.replace(A," "))}function o(e){for(var t=0,n={};t<e.length;t+=1)n[e[t].name]=e[t].value;return n}function i(e,t,n){var a=o(t),l=["'"+e+"'"];if(-1===y.indexOf(e)){for(var i in a)a.hasOwnProperty(i)&&(1===l.length&&(l.push(null),l.push(null)),l.push("'"+i+"'"),l.push(r(a[i],P.helpers.open,P.helpers.close)));n?s("v",l):s("o",l)}C=e}function p(e){var t;if(-1!==y.indexOf(C))l(e);else if(-1===w.indexOf(C))t=e.replace(A,"").trim(),t.length>0&&s("t",r(t,P.helpers.open,P.helpers.close),!0);else for(var n=e.split(A),a=0;a<n.length;a++)t=n[a],A.exec(t)?s("t",j,!0):s("t",r(t,P.helpers.open,P.helpers.close),!0)}function c(e){-1===y.indexOf(e)&&s("c",e)}var u=/^<([-A-Za-z0-9_]+)((?:[\s\w\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,f=/^<\/([-A-Za-z0-9_]+)[^>]*>/,h=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,m=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),d=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),g=e("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),b=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),v=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),x=e(""),O=function(e,t){function n(e,n,a,s){if(n=n.toLowerCase(),d[n])for(;o.last()&&g[o.last()];)r("",o.last());if(b[n]&&o.last()==n&&r("",n),s=m[n]||!!s,s||o.push(n),t.start){var l=[];a.replace(h,function(e,t){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:v[t]?t:"";l.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"')})}),t.start&&t.start(n,l,s)}}function r(e,n){var r;if(n)for(r=o.length-1;r>=0&&o[r]!=n;r--);else r=0;if(r>=0){for(var a=o.length-1;a>=r;a--)t.end&&t.end(o[a]);o.length=r}}var a,s,l,o=[],i=e;for(o.last=function(){return this[this.length-1]};e;){if(s=!0,o.last()&&x[o.last()])e=e.replace(new RegExp("(.*)</"+o.last()+"[^>]*>"),function(e,n){return n=n.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),t.chars&&t.chars(n),""}),r("",o.last());else if(0==e.indexOf("<!--")?(a=e.indexOf("-->"),a>=0&&(t.comment&&t.comment(e.substring(4,a)),e=e.substring(a+3),s=!1)):0==e.indexOf("</")?(l=e.match(f),l&&(e=e.substring(l[0].length),l[0].replace(f,r),s=!1)):0==e.indexOf("<")&&(l=e.match(u),l&&(e=e.substring(l[0].length),l[0].replace(u,n),s=!1)),s){a=e.indexOf("<");var p=0>a?e:e.substring(0,a);e=0>a?"":e.substring(a),t.chars&&t.chars(p)}if(e==i)throw"Parse Error: "+e;i=e}r()};const w=["pre","script"],y=["evaluate"],A=/(\r\n|\n|\r)/gm,j="String.fromCharCode(10)";"object"==typeof x&&(x[y]=!0);var k=[],C=null,P={parameterName:"data",functionName:function(e,t){return e},template:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},escape:/[&<>]/g,MAP:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ignore:"js",helpers:{open:"{%",close:"%}"}},z={compile:function(e){return n(),O(a(e),{start:i,chars:p,end:c}),new Function(P.parameterName,k.join(""))},options:function(e){for(var t in e)e.hasOwnProperty(t)&&(P[t]=e[t])}};return z});