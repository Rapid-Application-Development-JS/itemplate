!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.itemplate=t():e.itemplate=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a=n(1),r=n(2),s=n(3),i=n(5),o=n(6).createWrapper(),p=new i(o),u=new s(p),l={},d={compile:function(e,t,n,a){return p.reset(),p.set(Object.keys(l),n?Object.keys(n):[],a),o.set(t,l,null,e),u.parseComplete(r(e))},options:function(e){for(var t in e)e.hasOwnProperty(t)&&(a[t]=e[t])},registerHelper:function(e,t){l[e]=t},unregisterHelper:function(e){delete l[e]}};Object.defineProperty(d,"helpers",{get:function(){return l},set:function(){}}),e.exports=d},function(e,t){var n={BREAK_LINE:/(\r\n|\n|\r)\s{0,}/gm,template:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},order:["interpolate","escape","evaluate"],evaluate:{name:"script",open:"<script>",close:"</script>"},accessory:{open:"{%",close:"%}"},escape:/(&amp;|&lt;|&gt;|&quot;)/g,MAP:{"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},emptyString:!0,skipAttr:"skip",staticKey:"key",staticArray:"static-array",nonStaticAttributes:["id","name","ref"],binderPre:"::",helperPre:"i-",parameterName:"data",parentParameterName:"parent",renderContentFnName:"content",textSaveTags:["pre","code"],voidRequireTags:["input","area","base","br","col","command","embed","hr","img","keygen","link","meta","param","source","track","wbr"],debug:!1};e.exports=n},function(e,t,n){function a(e,t){return s.accessory.open+t+s.accessory.close}function r(e){for(var t=e,n=0;n<s.order.length;n++)t=i[s.order[n]](t);return t}var s=n(1),i={evaluate:function(e){return e.replace(s.template.evaluate,function(e,t){return s.evaluate.open+t.replace(s.BREAK_LINE," ").trim()+s.evaluate.close})},interpolate:function(e){return e.replace(s.template.interpolate,a)},escape:function(e){return e.replace(s.template.escape,a)}};e.exports=r},function(e,t,n){function a(e){this._builder=e,this.reset()}var r=n(4);a.prototype.reset=function(){this._state={mode:r.Text,pos:0,data:null,pendingText:null,pendingWrite:null,lastTag:null,isScript:!1,needData:!1,output:[],done:!1},this._builder.reset()},a.prototype.parseChunk=function(e){for(this._state.needData=!1,this._state.data=null!==this._state.data?this._state.data.substr(this.pos)+e:e;this._state.pos<this._state.data.length&&!this._state.needData;)this._parse(this._state)},a.prototype.parseComplete=function(e){return this.reset(),this.parseChunk(e),this.done()},a.prototype.done=function(){return this._state.done=!0,this._parse(this._state),this._flushWrite(),this._builder.done()},a.prototype._parse=function(){switch(this._state.mode){case r.Text:return this._parseText(this._state);case r.Tag:return this._parseTag(this._state);case r.Attr:return this._parseAttr(this._state);case r.CData:return this._parseCData(this._state);case r.Doctype:return this._parseDoctype(this._state);case r.Comment:return this._parseComment(this._state)}},a.prototype._writePending=function(e){this._state.pendingWrite||(this._state.pendingWrite=[]),this._state.pendingWrite.push(e)},a.prototype._flushWrite=function(){if(this._state.pendingWrite){for(var e=0,t=this._state.pendingWrite.length;t>e;e++){var n=this._state.pendingWrite[e];this._builder.write(n)}this._state.pendingWrite=null}},a.prototype._write=function(e){this._flushWrite(),this._builder.write(e)},a._re_parseText_scriptClose=/<\s*\/\s*script/gi,a.prototype._parseText=function(){var e,t=this._state;t.isScript?(a._re_parseText_scriptClose.lastIndex=t.pos,e=a._re_parseText_scriptClose.exec(t.data),e=e?e.index:-1):e=t.data.indexOf("<",t.pos);var n=-1===e?t.data.substring(t.pos,t.data.length):t.data.substring(t.pos,e);if(0>e&&t.done&&(e=t.data.length),0>e){if(t.isScript)return void(t.needData=!0);t.pendingText||(t.pendingText=[]),t.pendingText.push(t.data.substring(t.pos,t.data.length)),t.pos=t.data.length}else t.pendingText?(t.pendingText.push(t.data.substring(t.pos,e)),n=t.pendingText.join(""),t.pendingText=null):n=t.data.substring(t.pos,e),""!==n&&this._write({type:r.Text,data:n}),t.pos=e+1,t.mode=r.Tag},a.re_parseTag=/\s*(\/?)\s*([^\s>\/]+)(\s*)\??(>?)/g,a.prototype._parseTag=function(){var e=this._state;a.re_parseTag.lastIndex=e.pos;var t=a.re_parseTag.exec(e.data);if(t){if(!t[1]&&"!--"===t[2].substr(0,3))return e.mode=r.Comment,void(e.pos+=3);if(!t[1]&&"![CDATA["===t[2].substr(0,8))return e.mode=r.CData,void(e.pos+=8);if(!t[1]&&"!DOCTYPE"===t[2].substr(0,8))return e.mode=r.Doctype,void(e.pos+=8);if(!e.done&&e.pos+t[0].length===e.data.length)return void(e.needData=!0);var n;">"===t[4]?(e.mode=r.Text,n=t[0].substr(0,t[0].length-1)):(e.mode=r.Attr,n=t[0]),e.pos+=t[0].length;var s={type:r.Tag,name:t[1]+t[2],raw:n,position:a.re_parseTag.lastIndex};e.mode===r.Attr&&(e.lastTag=s),"script"===s.name.toLowerCase()?e.isScript=!0:"/script"===s.name.toLowerCase()&&(e.isScript=!1),e.mode===r.Attr?this._writePending(s):this._write(s)}else e.needData=!0},a.re_parseAttr_findName=/\s*([^=<>\s'"\/]+)\s*/g,a.prototype._parseAttr_findName=function(){a.re_parseAttr_findName.lastIndex=this._state.pos;var e=a.re_parseAttr_findName.exec(this._state.data);return e?this._state.pos+e[0].length!==a.re_parseAttr_findName.lastIndex?null:{match:e[0],name:e[1]}:null},a.re_parseAttr_findValue=/\s*=\s*(?:'([^']*)'|"([^"]*)"|([^'"\s\/>]+))\s*/g,a.re_parseAttr_findValue_last=/\s*=\s*['"]?(.*)$/g,a.prototype._parseAttr_findValue=function(){var e=this._state;a.re_parseAttr_findValue.lastIndex=e.pos;var t=a.re_parseAttr_findValue.exec(e.data);return t?e.pos+t[0].length!==a.re_parseAttr_findValue.lastIndex?null:{match:t[0],value:t[1]||t[2]||t[3]}:e.done?(a.re_parseAttr_findValue_last.lastIndex=e.pos,t=a.re_parseAttr_findValue_last.exec(e.data),t?{match:t[0],value:""!==t[1]?t[1]:null}:null):null},a.re_parseAttr_splitValue=/\s*=\s*['"]?/g,a.re_parseAttr_selfClose=/(\s*\/\s*)(>?)/g,a.prototype._parseAttr=function(){var e=this._state,t=this._parseAttr_findName(e);if(t&&"?"!==t.name){if(!e.done&&e.pos+t.match.length===e.data.length)return e.needData=!0,null;e.pos+=t.match.length;var n=this._parseAttr_findValue(e);if(n){if(!e.done&&e.pos+n.match.length===e.data.length)return e.needData=!0,void(e.pos-=t.match.length);e.pos+=n.match.length}else if(e.data.indexOf(" ",e.pos-1))n={match:"",value:null};else{if(a.re_parseAttr_splitValue.lastIndex=e.pos,a.re_parseAttr_splitValue.exec(e.data))return e.needData=!0,void(e.pos-=t.match.length);n={match:"",value:null}}e.lastTag.raw+=t.match+n.match,this._writePending({type:r.Attr,name:t.name,data:n.value})}else{a.re_parseAttr_selfClose.lastIndex=e.pos;var s=a.re_parseAttr_selfClose.exec(e.data);if(s&&s.index===e.pos){if(!e.done&&!s[2]&&e.pos+s[0].length===e.data.length)return void(e.needData=!0);e.lastTag.raw+=s[1],this._write({type:r.Tag,name:"/"+e.lastTag.name,raw:null}),e.pos+=s[1].length}var i=e.data.indexOf(">",e.pos);if(0>i){if(e.done)return e.lastTag.raw+=e.data.substr(e.pos),void(e.pos=e.data.length);e.needData=!0}else e.pos=i+1,e.mode=r.Text}},a.re_parseCData_findEnding=/\]{1,2}$/,a.prototype._parseCData=function(){var e=this._state,t=e.data.indexOf("]]>",e.pos);if(0>t&&e.done&&(t=e.data.length),0>t){a.re_parseCData_findEnding.lastIndex=e.pos;var n=a.re_parseCData_findEnding.exec(e.data);if(n)return void(e.needData=!0);e.pendingText||(e.pendingText=[]),e.pendingText.push(e.data.substr(e.pos,e.data.length)),e.pos=e.data.length,e.needData=!0}else{var s;e.pendingText?(e.pendingText.push(e.data.substring(e.pos,t)),s=e.pendingText.join(""),e.pendingText=null):s=e.data.substring(e.pos,t),this._write({type:r.CData,data:s}),e.mode=r.Text,e.pos=t+3}},a.prototype._parseDoctype=function(){var e=this._state,t=e.data.indexOf(">",e.pos);if(0>t&&e.done&&(t=e.data.length),0>t)a.re_parseCData_findEnding.lastIndex=e.pos,e.pendingText||(e.pendingText=[]),e.pendingText.push(e.data.substr(e.pos,e.data.length)),e.pos=e.data.length,e.needData=!0;else{var n;e.pendingText?(e.pendingText.push(e.data.substring(e.pos,t)),n=e.pendingText.join(""),e.pendingText=null):n=e.data.substring(e.pos,t),this._write({type:r.Doctype,data:n}),e.mode=r.Text,e.pos=t+1}},a.re_parseComment_findEnding=/\-{1,2}$/,a.prototype._parseComment=function(){var e=this._state,t=e.data.indexOf("-->",e.pos);if(0>t&&e.done&&(t=e.data.length),0>t){a.re_parseComment_findEnding.lastIndex=e.pos;var n=a.re_parseComment_findEnding.exec(e.data);if(n)return void(e.needData=!0);e.pendingText||(e.pendingText=[]),e.pendingText.push(e.data.substr(e.pos,e.data.length)),e.pos=e.data.length,e.needData=!0}else{var s;e.pendingText?(e.pendingText.push(e.data.substring(e.pos,t)),s=e.pendingText.join(""),e.pendingText=null):s=e.data.substring(e.pos,t),this._write({type:r.Comment,data:s}),e.mode=r.Text,e.pos=t+3}},e.exports=a},function(e,t){var n={Text:"text",Tag:"tag",Attr:"attr",CData:"cdata",Doctype:"doctype",Comment:"comment"};e.exports=n},function(e,t,n){function a(){return 0===V.level}function r(){for(var e=new Array(12),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgijklmnopqrstuvwxyz",n=0;12>n;n++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join(P)}function s(e,t){var n,a,r,s=new RegExp(k.accessory.open+"|"+k.accessory.close,"g"),i=!0;return n=void 0!==e?e.split(s).map(function(e,n){return a="",r="",n%2?(i=!1,e=e.trim(),k.emptyString&&!t?(-1!==e.indexOf(" ")&&(a="(",r=")")," + ("+a+e+r+' === undefined ? "" : '+a+e+r+") + "):" + "+e+" + "):JSON.stringify(e)}).join(""):'""',n=n.replace(/^"" \+ | \+ ""$/g,"").replace(/ \+ "" \+ /g," + "),{value:n,isStatic:i}}function i(e){return e.trim().replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)}).replace(k.escape,function(e){return k.MAP[e]})}function o(e,t,n){var a,i,o=P;return e!==O.elementOpen&&e!==O.elementVoid||(t&&t.hasOwnProperty(k.staticKey)?(a=s(t[k.staticKey]||r()),delete t[k.staticKey]):a=n?{value:O.getKey}:{value:"null"},i=Object.keys(t).length>0?", ":P,o=", "+a.value+i),o}function p(e,t){var n,a,o,p=P,u=!1,l=!1;if((e===O.elementOpen||e===O.elementVoid)&&Object.keys(t).length>0){t&&t.hasOwnProperty(k.staticArray)&&(u=t[k.staticArray]||r(),E[u]=E[u]||{},delete t[k.staticArray]),t&&t.hasOwnProperty(k.skipAttr)&&(l=!0,o=O.startSkipContent(s(t[k.skipAttr],!0).value),delete t[k.skipAttr]),p=u||null;for(var d in t)if(n=t[d],n=null===n?d:void 0===n?"":n,a=s(n),a.isStatic&&-1===k.nonStaticAttributes.indexOf(d))if(u){var c=i(n);E[u].hasOwnProperty(d)?E[u][d]!==c&&(E[u][d]=j,p+=I+d+'", "'+c+N):E[u][d]=c}else p+=I+d+'", "'+i(n)+N;else p+=I+d+'", '+i(a.value)}return{value:p,isSkipped:l,skip:o}}function u(e){var t,n,a={};for(var r in e){t=e[r],a[r]=[];for(n in t)t[n]!==j&&a[r].push(N+n+N,N+t[n]+N)}return a}function l(e){var t=["{"];for(var n in e)t.push((t.length>1?",":P)+"'"+n+"':"+s(e[n],!0).value);return t.push("}"),t.join(P)}function d(e){return e.replace(/\s/g,"").replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function c(e,t,n){if(n&&n.ref){var a=n.ref;delete n.ref}var r=o(e,n),i=p(e,n);a&&(e=O.saveRef(d(s(a,!0).value),e)),C.push(e+t+N+r+i.value+O.close),i.isSkipped&&(C.push(i.skip),V.skip.push(V.level))}function f(e){if(e=i(e),e.length>0){var t=s(e);C.push(O.text+t.value+O.close)}}function h(e,t){C.push(O.helpers+'["'+e+'"]('+l(t)+", function ("+k.parentParameterName+"){")}function g(){C.push("}.bind(this));")}function _(e){return-1!==S.indexOf(e)||-1!==w.indexOf(e)||0===e.indexOf(k.helperPre)}function m(e,t){var n=e.replace(k.binderPre,"");C.push(O.binder+"("+n+","+l(t)+", function ("+k.parentParameterName+"){")}function v(){C.push("}.bind(this));")}function x(e){return 0===e.indexOf(k.binderPre)}function y(e){var t=!0;if(b.tag){var n=a();_(b.tag)?(h(b.tag,b.attributes),t=e):x(b.tag)?(m(b.tag,b.attributes),t=e):e||-1!==k.voidRequireTags.indexOf(b.tag)?(c(O.elementVoid,b.tag,b.attributes,n),V.level--,t=!1):b.tag!==k.evaluate.name&&c(O.elementOpen,b.tag,b.attributes,n),V.level++}return b.tag=null,b.attributes={},t}function T(e){A=e,this.reset()}var b,C,A,w,k=n(1),D=n(4),O=n(6).Command,E={},S=[],P="",N='"',I=', "',j="-%%&&##__II-",V={level:0,skip:[]};T.prototype.reset=function(){C=[],b={tag:null,attributes:{}},E={},V={level:0,skip:[]}},T.prototype.set=function(e,t){w=e,S=t||[]},T.prototype.write=function(e){var t;switch(e.type){case D.Tag:t=e.name.replace("/",P),0===e.name.indexOf("/")?y(!0)&&t!==k.evaluate.name&&(V.level--,V.level===V.skip[V.skip.length-1]&&(C.push(O.endSkipContent),V.skip.pop()),_(t)?g():x(t)?v():c(O.elementClose,t)):(y(),b.tag=t,b.attributes={});break;case D.Attr:b.attributes[e.name]=e.data;break;case D.Text:t=b.tag,y(),t===k.evaluate.name?C.push(i(e.data)):f(e.data);break;case D.Comment:k.debug&&C.push("\n// "+e.data.replace(k.BREAK_LINE," ")+"\n")}},T.prototype.done=function(){return A(C,u(E))},e.exports=T},function(e,t,n){function a(){function e(e){var t=p+" return _r;",n="var TE=function(m,n,o){this.original=o;this.name=n;(o)?this.stack=this.original.stack:this.stack=null;this.message=o.message+m;};var CE=function(){};CE.prototype=Error.prototype;TE.prototype=new CE();TE.prototype.constructor=TE;";return r.debug?"try {"+e+"} catch (err) {"+n+"throw new TE("+JSON.stringify(i)+", err.name, err);}"+t:e+t}function t(t,s){var i,u=["var _o = _l.elementOpen;","var _c = _l.elementClose;","var _v = _l.elementVoid;","var _t = _l.text;","var _r = {};","_b = _b || function(fn, data, content){ return fn(data, content); };"].join(p)+p;for(var l in s)s.hasOwnProperty(l)&&(u+="var "+l+"=["+s[l]+"];");var d=u+e(t.join(o));return n?(d="return function("+r.parameterName+", "+r.renderContentFnName+", _b){"+d+"};",i=new Function("_l","_h",d)(n,a)):i=new Function(r.parameterName,"_l","_h",r.renderContentFnName,"_b",d),i}var n,a,s,i,o="",p="\n";return t.set=function(e,t,r,o){n=e,a=t,s=r,i=o},t}var r=n(1),s={helpers:"_h",binder:"_b",elementOpen:'_o("',elementClose:'_c("',elementVoid:'_v("',saveRef:function(e,t){return"_r["+e+"] = "+t},text:"_t(",close:");\n",startSkipContent:function(e){return e='"false"'===e?!1:e,e='"true"'===e?!0:e,"if("+e+"){_l.skip();}else{"},endSkipContent:"}"};e.exports={createWrapper:a,Command:s}}])});